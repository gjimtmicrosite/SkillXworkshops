<!DOCTYPE html>
<html>
<head>
<title>SkillX Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:Poppins,Arial;
  background:#f4f6fb;
  margin:0;
}
.quiz-box{
  max-width:850px;
  margin:40px auto;
  background:#fff;
  padding:30px;
  border-radius:14px;
  box-shadow:0 15px 40px rgba(0,0,0,.15);
}
h2{color:#6a1b9a}
.option{
  padding:12px;
  border:1px solid #ccc;
  margin:10px 0;
  border-radius:6px;
  cursor:pointer;
}
.option:hover{background:#ede7f6}
.option.selected{
  background:#6a1b9a;
  color:#fff;
}
button{
  margin-top:20px;
  padding:12px 22px;
  background:#6a1b9a;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
button:disabled{
  background:#bbb;
  cursor:not-allowed;
}
</style>
</head>

<body>

<div class="quiz-box">
  <h2 id="title"></h2>
  <p id="question"></p>
  <div id="options"></div>
  <button id="nextBtn" onclick="next()" disabled>Next</button>
</div>

<script>
// ================== QUIZ CONTEXT ==================
const quizInfo = JSON.parse(localStorage.getItem("currentQuiz"));
let questions=[], index=0, score=0, selected=null;

document.getElementById("title").innerText =
`${quizInfo.workshop} | Day ${quizInfo.day} | ${quizInfo.level.toUpperCase()}`;

// ================== AUTO QUESTION GENERATOR ==================
function generateQuestions(){
  const topic = quizInfo.workshop;
  const level = quizInfo.level;

  const correctTemplates = [
    `Optimizing keywords relevant to ${topic}`,
    `Structuring content clearly for recruiters in ${topic}`,
    `Highlighting measurable achievements related to ${topic}`,
    `Improving visibility using industry-specific terms in ${topic}`,
    `Aligning profile content with job roles in ${topic}`
  ];

  const wrongTemplates = [
    `Using decorative fonts and colors`,
    `Adding irrelevant personal information`,
    `Copy-pasting the same content everywhere`,
    `Ignoring keywords and ATS requirements`,
    `Focusing only on academic marks`
  ];

  for(let i=1;i<=20;i++){

    // pick correct answer
    const correctAnswer =
      correctTemplates[i % correctTemplates.length];

    // pick 3 wrong answers
    const wrongAnswers = shuffleArray(wrongTemplates)
                          .slice(0,3);

    // combine & shuffle
    const options = shuffleArray([
      correctAnswer,
      ...wrongAnswers
    ]);

    questions.push({
      q: `( ${level.toUpperCase()} ) Q${i}: What is an important concept of ${topic}?`,
      options: options,
      answer: options.indexOf(correctAnswer) // correct index
    });
  }
}

// utility shuffle
function shuffleArray(arr){
  return arr.sort(()=>Math.random()-0.5);
}

// ================== START QUIZ ==================
generateQuestions();
render();

// ================== RENDER ==================
function render(){
  selected=null;
  document.getElementById("nextBtn").disabled=true;

  const q=questions[index];
  document.getElementById("question").innerText =
  `${index+1}. ${q.q}`;

  const optDiv=document.getElementById("options");
  optDiv.innerHTML="";

  q.options.forEach((o,i)=>{
    const d=document.createElement("div");
    d.className="option";
    d.innerText=o;

    d.onclick=()=>{
      document.querySelectorAll(".option")
        .forEach(x=>x.classList.remove("selected"));
      d.classList.add("selected");
      selected=i;
      document.getElementById("nextBtn").disabled=false;
    };

    optDiv.appendChild(d);
  });
}

// ================== NEXT ==================
function next(){
  if(selected === questions[index].answer) score++;
  index++;

  if(index < questions.length){
    render();
  }else{
    finish();
  }
}

// ================== FINISH ==================
function finish(){
  const percent=(score/questions.length)*100;
  alert(`Quiz Completed!\nScore: ${percent.toFixed(2)}%`);

  let progress=JSON.parse(localStorage.getItem("quizProgress"))||{
    day:1,
    completed:{}
  };

  if(percent>=50){
    progress.completed[
      `${quizInfo.day}-${quizInfo.level}`
    ]=true;

    const levels=["simple","moderate","expert"];
    if(levels.every(l=>progress.completed[`${quizInfo.day}-${l}`])){
      progress.day=Math.max(progress.day,quizInfo.day+1);
    }
  }

  localStorage.setItem("quizProgress",JSON.stringify(progress));
  window.location.href="dashboard.html";
}
</script>

</body>
</html>

