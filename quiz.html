<!DOCTYPE html>
<html>
<head>
  <title>SkillX Quiz</title>
</head>
<body>

<h2 id="title"></h2>
<p id="student"></p>

<div id="quiz"></div>

<script>
  const student = JSON.parse(localStorage.getItem("student"));
const qs = JSON.parse(localStorage.getItem("quizSettings"));

student.progress["day"+qs.day][qs.level] = true;

student.results.push({
  day: qs.day,
  level: qs.level,
  score: score,
  total: total
});

localStorage.setItem("student", JSON.stringify(student));

const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzmXddZWx9nLD3JcawXDgfyoh5pGCa_7eF9IW_ctaGvXGKuAVCrx-uvZT42zCkq9c8/exec";

const student = JSON.parse(localStorage.getItem("student"));
const settings = JSON.parse(localStorage.getItem("quizSettings"));

if (!student || !settings) {
  alert("Quiz data missing. Go back to dashboard.");
  window.location.href = "dashboard.html";
}

document.getElementById("title").innerText =
  settings.workshop + " | Day " + settings.day + " | " + settings.level.toUpperCase();

document.getElementById("student").innerText =
  "Student: " + student.name;

fetch(WEB_APP_URL, {
  method: "POST",
  body: new URLSearchParams({
    action: "quiz",
    topic: settings.workshop,
    level: settings.level,
    day: settings.day
  })
})
.then(res => res.json())
.then(data => {
  if (!data.success) throw "AI failed";

  const container = document.getElementById("quiz");
  data.questions.forEach((q, i) => {
    container.innerHTML += `
      <p><b>${i+1}. ${q.question}</b></p>
      ${q.options.map((o, idx) =>
        `<label><input type="radio" name="q${i}"> ${o}</label><br>`
      ).join("")}
      <hr>`;
  });
})
.catch(err => {
  alert("Quiz generation failed");
  console.error(err);
});
</script>

</body>
</html>





